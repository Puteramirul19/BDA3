@model BDA.ViewModel.InstructionLetterViewModel
@{
    Layout = null;
    int no = 1;
    decimal total = 0;
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Instruction Letter</title>
</head>
<body style="font-family:Arial, Helvetica, sans-serif; font-size:12pt">

    <div class="content" style='page-break-after: auto;'>
        <p><br /></p>
        <p><br /></p>
        <p><br /></p>
        <p style="float:left">Rujukan Kami: TNB/KEW (UP) B 14/8/Deraf</p>
        <p style="float:right">@Convert.ToDateTime(Model.LetterDate).ToString("dd MMMM yyyy")</p>
        <p><br /></p>
        <p>
            <br />@Model.AddressLine1,
            <br />@Model.AddressLine2,
            <br />@Model.AddressLine3,
            <br />@Model.State
        </p>
        <p>
            <b>
                <u>
                    U/Perhatian : @Model.BankPIC
                </u>
            </b>
        </p>
        <p>
            Tuan/Puan,
        </p>
        <p>
            <b>
                <u>
                    DERAF BANK PADA @Model.ValueDate (@Model.ValueDateDay)
                </u>
            </b>
        </p>
        <p>
            Sila uruskan deraf bank dalam matawang <b>Ringgit Malaysia</b> seperti berikut :
        </p>
        @if (Model.Penerimas.Count() <= 5)
        {
            <table style="font-weight:bold; border:0px; width:100%;" cellpadding="7px">
                <thead>
                    <tr>
                        <th width="5%">&nbsp;</th>
                        <th><u>Nama Penerima</u></th>
                        <th width="15%" style="text-align:center"><u>Tempat</u></th>
                        <th width="20%" style="text-align:center"><u>Jumlah (RM)</u></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var wc in Model.Penerimas)
                    {
                        <tr>
                            <td>@no.</td>
                            <td>@wc.NamaPenerima</td>
                            <td style="text-align:center">@wc.Tempat</td>
                            <td style="text-align:right">RM @Convert.ToDecimal(wc.Jumlah).ToString("#,##0.00")</td>
                        </tr>
                        total = total + wc.Jumlah ?? 0;
                        no++;
                    }
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td style="text-align:center">Jumlah</td>
                        <td style="text-align:right; border: 1px solid black;border-right:0px;border-left:0px;">RM @Convert.ToDecimal(total).ToString("#,##0.00")</td>
                    </tr>
                </tbody>
            </table>
        }
        <p>
            Ringgit : @Model.RinggitText
        </p>
        <p>
            Sila debit Akaun TNB berikut :
            <ul>
                <li>
                    <b>@Model.BankAccount</b> bagi jumlah diatas
                </li>
                <li>
                    <b>@Model.ChargedBankAccount</b> untuk caj bank.
                </li>
            </ul>
        </p>
        <p>
            <b>
                Ref: @Model.Remarks
            </b>
        </p>
        <p>
            Sekian, terima kasih.
        </p>
        <p>
            <center>
                <b>
                    <i>
                        "BETTER. BRIGHTER."
                        <br />"TNB MENGAMALKAN DASAR TIADA HADIAH"
                    </i>
                </b>
            </center>
        </p>
        <br />
        <br />
        <p>
            Yang benar,
        </p>
        <p>
            <br />
            <br />
            <br />
            <table style="border:0px; width:100%">
                <tr>
                    <td style="border-top:1px solid" width="25%">Penandatangan Yang Diberikuasa</td>
                    <td width="25%"></td>
                    @*<td width="25%"></td>*@
                    <td style="border-top:1px solid" width="25%">Penandatangan Yang Diberikuasa</td>
                </tr>
            </table>
        </p>
        <div style="float:right">
            <span style="border:1px solid rgba(0,0,0,0.5); padding:5px">
                FSTL-750-03-QR02
            </span>
        </div>
    </div>
    @if (Model.Penerimas.Count() > 5)
    {
        <div class="content" style='page-break-before: always;'>
            <u><span style="font-size:small">Lampiran 1</span></u>
            <table style="border:10px; width:100%;" cellpadding="7px" border="2">
                <thead>
                    <tr>
                        <th width="5%">&nbsp;</th>
                        <th><u>Nama Penerima</u></th>
                        <th width="15%" style="text-align:center"><u>Tempat</u></th>
                        <th width="20%" style="text-align:center"><u>Jumlah (RM)</u></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var wc in Model.Penerimas)
                    {
                        <tr>
                            <td>@no.</td>
                            <td>@wc.NamaPenerima</td>
                            <td style="text-align:center">@wc.Tempat</td>
                            <td style="text-align:center">@Convert.ToDecimal(wc.Jumlah).ToString("#,##0.00")</td>
                        </tr>
                        total = total + wc.Jumlah ?? 0;
                        no++;
                    }
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td style="text-align:center">Jumlah</td>
                        <td style="text-align:center">@Convert.ToDecimal(total).ToString("#,##0.00")</td>
                    </tr>

                </tbody>
            </table>
        </div>
    }
    @*<p>
        Yang benar,
    </p>*@
    @*<p>
        <br />
        <br />
        <br />
        <table style="border:0px; width:100%">
            <tr>
                <td style="border-top:1px solid" width="25%">Penandatangan Yang Diberikuasa</td>
                <td width="25%"></td>
                <td width="25%"></td>
                @*<td style="border-top:1px solid" width="25%">Penandatangan Yang Diberikuasa</td>
            </tr>
        </table>
    </p>*@
</body>
</html>
