@model BDA.ViewModel.InstructionLetterViewModel
@{
    Layout = null;
    int numFirst = 1;
    int numSecond = 1;
    decimal totalFirst = 0;
    decimal totalSecond = 0;
    decimal totalSecondFinal = 0;
    string ringgit = char.ToUpper(@Model.RinggitText[0]) + @Model.RinggitText.Substring(1);
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Instruction Letter</title>
    <style type="text/css">
        .BDList th, .BDList tr, .BDList td {
            border: 1px solid;
        }
        #footer {
            position: absolute;
            left: 0px;
            bottom: 0px;
            height: 30px;
            width: 100%;
            background: #999;
        }
        thead {
            display: table-header-group
        }
        tfoot {
            display: table-row-group
        }

        tr {
            page-break-inside: avoid
        }
        #currency:first-letter{
            text-transform:capitalize;
        }
    </style>
</head>
<body style="font-family:Arial; font-size:11pt">
    <div class="content" style='page-break-after: auto;'>
        <p><br /></p>
        <p><br /></p>
        <p><br /></p>
        <p style="float:left">Rujukan Kami: TNB/KEW (UP) B 14/8/Deraf</p>
        <p style="float:right">@Convert.ToDateTime(Model.LetterDate).ToString("dd MMMM yyyy")</p>
        <p><br /></p>
        <p>
            <br />@Model.AddressLine1,
            <br />@Model.AddressLine2,
            <br />@Model.AddressLine3,
            <br />@Model.State
        </p>
        <p>
            <b>
                <u>
                    U/Perhatian : @Model.BankPIC
                </u>
            </b>
        </p>
        <p>
            Tuan/Puan,
        </p>
        <p>
            <b>
                <u>
                    DERAF BANK PADA @Model.ValueDate (@Model.ValueDateDay)
                </u>
            </b>
        </p>
        <p>
            Sila uruskan deraf bank dalam matawang <b>Ringgit Malaysia</b> seperti berikut :
        </p>
        @if (Model.Penerimas.Count() <= 6)
        {
            <table style="font-weight:bold; border:0px; width:100%;" cellpadding="7px">
                <thead>
                    <tr>
                        <th width="5%">&nbsp;</th>
                        <th><u>Nama Penerima</u></th>
                        <th width="20%" style="text-align:center"><u>Tempat</u></th>
                        <th width="20%" style="text-align:center"><u>Jumlah (RM)</u></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var wc in Model.Penerimas)
                    {
                        <tr>
                            <td>@numFirst</td>
                            <td>@wc.NamaPenerima</td>
                            <td style="text-align:center">@wc.Tempat</td>
                            <td style="text-align:right">RM @Convert.ToDecimal(wc.Jumlah).ToString("#,##0.00")</td>
                        </tr>
                        totalFirst = totalFirst + wc.Jumlah ?? 0;
                        numFirst++;
                    }
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td style="text-align:center">Jumlah</td>
                        <td style="text-align:right; border: 1px solid black;border-right:0px;border-left:0px;">RM @Convert.ToDecimal(totalFirst).ToString("#,##0.00")</td>
                    </tr>
                </tbody>
            </table>
        }
        @if (Model.Penerimas.Count() > 6)
        {

            <table style="font-weight:bold; border:0px; width:100%;" cellpadding="7px">
                <thead>
                    <tr>
                        <th width="5%">&nbsp;</th>
                        <th><u>Nama Penerima</u></th>
                        <th width="20%" style="text-align:center"><u></u></th>
                        <th width="20%" style="text-align:center"><u>Jumlah (RM)</u></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var wc in Model.Penerimas)
                    {
                        totalSecond = totalSecond + wc.Jumlah ?? 0;
                    }
                    <tr>
                        <td></td>
                        <td><b>SEPERTI DI LAMPIRAN A</b></td>
                        <td style="text-align:center"></td>
                        <td style="text-align:right">RM @Convert.ToDecimal(totalSecond).ToString("#,##0.00")</td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td style="text-align:center">Jumlah</td>
                        <td style="text-align:right; border: 1px solid black;border-right:0px;border-left:0px;">RM @Convert.ToDecimal(totalSecond).ToString("#,##0.00")</td>
                    </tr>
                </tbody>
            </table>
        }
            <p>
                Ringgit : @ringgit
            </p>
        <p>
            Sila debit Akaun TNB berikut :
            <ul>
                <li>
                    <b>@Model.BankAccount</b> bagi jumlah diatas
                </li>
                <li>
                    <b>@Model.ChargedBankAccount</b> untuk caj bank.
                </li>
            </ul>
        </p>
        <p>
            <b>
                Ref: @Model.Remarks
            </b>
        </p>
        <p>
            Sekian, terima kasih.
        </p>
        <p>
            <center>
                <b>
                    <i>
                        "BETTER. BRIGHTER."
                        <br />"TNB MENGAMALKAN DASAR TIADA HADIAH"
                    </i>
                </b>
            </center>
        </p>
        <br />
        <br />
        <p>
            Yang benar,
        </p>
        <p>
            <br />
            <br />
            <br />
            <table style="border:0px; width:100%">
                <tr>
                    <td style="border-top:1px solid" width="25%">Penandatangan Yang Diberikuasa</td>
                    <td width="25%"></td>
                    @*<td width="25%"></td>*@
                    <td style="border-top:1px solid" width="25%">Penandatangan Yang Diberikuasa</td>
                </tr>
            </table>
        </p>
        <div style="float:right">
            <span style="border:1px solid rgba(0,0,0,0.5); padding:5px">
                FSTL-750-03-QR02
            </span>
        </div>
    </div>
    @if (Model.Penerimas.Count() > 6)
    {
        <div class="content" style='page-break-before: always;'>
            <div style="text-align:center">
                <u><span style="font-size:small">LAMPIRAN A - PERMOHONAN DERAF BARU</span></u><br />
                <u> @Model.ValueDate (@Model.ValueDateDay)</u>
            </div>
            @*<table style="border:2px; width:100%;" cellpadding="7px" border="1">*@
            <table class="BDList" cellpadding="7" cellspacing="0">
                @*<thead style="display: table-row-group;">*@
                <thead style="display: table-header-group">
                    <tr>
                        <th width="5%">&nbsp;</th>
                        <th><u>Nama Penerima</u></th>
                        <th width="20%" style="text-align:center"><u>Tempat</u></th>
                        <th width="20%" style="text-align:center"><u>Jumlah (RM)</u></th>
                    </tr>
                </thead>
                <tbody style="display: table-row-group">
                    @foreach (var wc in Model.Penerimas)
                    {
                        <tr>
                            <td>@numSecond</td>
                            <td>@wc.NamaPenerima</td>
                            <td style="text-align:center">@wc.Tempat</td>
                            <td style="text-align:center">@Convert.ToDecimal(wc.Jumlah).ToString("#,##0.00")</td>
                        </tr>
                        totalSecondFinal = totalSecondFinal + wc.Jumlah ?? 0;
                        numSecond++;
                    }
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td style="text-align:center">Jumlah</td>
                        <td style="text-align:center">@Convert.ToDecimal(totalSecondFinal).ToString("#,##0.00")</td>
                    </tr>

                </tbody>
                <tfoot style="display: table-footer-group;">
                    <tr>Yang Benar</tr>
                    <tr><p></p></tr>
                    <tr>Penandatangan Yang Diberikuasa</tr>
                </tfoot>
            </table>
            <br />
            <div style="text-align:center">
                <b>TENAGA NASIONAL BERHAD</b>
            </div>
        </div>
        @*<p>
            <br />
            <br />
            <br />
            <table style="border:0px; width:100%">
                <tr>
                    <td style="border-top:1px solid" width="25%">Penandatangan Yang Diberikuasa</td>
                    <td width="25%"></td>
                    <td style="border-top:1px solid" width="25%">Penandatangan Yang Diberikuasa</td>
                </tr>
            </table>
            <br />
            <div style="float:right">
                <span style="border:1px solid rgba(0,0,0,0.5); padding:5px">
                    FSTL-750-03-QR02
                </span>
            </div>
        </p>*@
    }
</body>
</html>
